# 玻璃质感

Matcap采样反射Matcap反射贴图
叠加(厚度图+边缘)乘折射图 注意透明度和渲染队列的处理

## Matcap

```C++
 float3 view_dir = normalize(_WorldSpaceCameraPos - i.world_pos);
//MatCap 反射图
float3 view_pos = mul(UNITY_MATRIX_V, float4(i.world_pos, 1.0));
float3 view_normal = mul(UNITY_MATRIX_V, i.world_normal);
float3 view_pcn = cross(normalize(view_pos), normalize(view_normal));
float2 matCapUV = float2(-view_pcn.y, view_pcn.x)* 0.5 + 0.5;
//float2 matCapUV_Classic = (view_normal * 0.5 + 0.5).xy;
float4 matCapColor = tex2D(_MatCap, matCapUV);

```

## 折射贴图

```C++
//厚度图
float thicknessColor = tex2D(_ThicknessMap, i.uv).r;
thicknessColor = smoothstep(_ThicknessSmooth.x, _ThicknessSmooth.y,thicknessColor) * _ThicknessStrength;
//边缘折射
float VdotN = dot(view_dir, i.world_normal);
float fresnel = _Fresnel.x + _Fresnel.y * pow(1.0 - VdotN, _Fresnel.z);
float refactArea = fresnel + thicknessColor * _RefractInstensity;
//折射图
float4 refractTex = tex2D(_RefractionMap, matCapUV + thicknessColor * _ReflactStrength);
float4 refractColor = refractTex * refactArea;
```